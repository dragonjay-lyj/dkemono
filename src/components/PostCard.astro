---
interface Props {
  title: string;
  cover: string;
  publishDate: Date;
  attachments: number;
  slug: string;
}

const { title, cover, publishDate, attachments, slug } = Astro.props;

// 数据验证：确保关键字段不为空，若为空则提供默认值或提示
const displayTitle = title || 'Untitled Post';
const displayCover = cover || '/images/default-cover.jpg';
const displayPublishDate = publishDate || null;
const displayAttachments = attachments >= 0 ? attachments : 0;
---

<a
  href={`/posts/${slug}`}
  class="relative block rounded-xl overflow-hidden shadow-lg group transition-transform duration-500 hover:scale-105 focus:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 will-change-transform"
  aria-label={`View post titled ${displayTitle}`}
  tabindex="0"
>
  <!-- 封面图片区域，带有悬停缩放效果，优化性能使用will-change -->
  <div class="relative w-full h-48 xs:h-56 sm:h-64 overflow-hidden will-change-transform">
    <img
      src={displayCover}
      alt={`${displayTitle} cover image`}
      class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110 group-focus:scale-110"
      loading="lazy"
      decoding="async"
    />
    <!-- 上方渐变遮罩，增强标题可读性，响应式高度调整 -->
    <div class="absolute top-0 left-0 right-0 bg-gradient-to-b from-gray-900/90 to-transparent h-10 xs:h-12 sm:h-16 z-10"></div>
    <!-- 下方渐变遮罩，增强信息可读性，响应式高度调整 -->
    <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-gray-900/90 to-transparent h-10 xs:h-12 sm:h-16 z-10"></div>
  </div>

  <!-- 标题区域，位于卡片顶部，响应式文本大小 -->
  <div class="absolute top-0 left-0 p-2 xs:p-3 sm:p-4 z-20">
    <h3 class="text-white text-sm xs:text-base sm:text-lg md:text-xl font-bold line-clamp-2" title={displayTitle}>{displayTitle}</h3>
  </div>

  <!-- 信息区域，位于卡片底部，响应式文本大小，悬停渐显效果 -->
  <div class="absolute bottom-0 left-0 p-2 xs:p-3 sm:p-4 z-20 opacity-80 group-hover:opacity-100 group-focus:opacity-100 transition-opacity duration-300">
    <p class="text-white text-xs sm:text-sm">
      已发布： {displayPublishDate ? displayPublishDate.toLocaleDateString() : 'N/A'}
    </p>
    <p class="text-white text-xs sm:text-sm">附件： {displayAttachments}</p>
  </div>

  <!-- 卡片悬停时的额外装饰效果，优化性能使用简单边框变化 -->
  <div class="absolute inset-0 border-2 border-transparent group-hover:border-white/20 group-focus:border-white/20 transition-all duration-500 rounded-xl"></div>
</a>